domain: credits
name: balance

entity:
  schema:
    properties:
      balance:
        type: integer
        default: 10
  initialized: true

operations:
  transit:
    concurrency: none
    input:
      properties:
        balance: ~
  deduce:
    concurrency: none
    input: integer
    output: integer
    query: true
  debit:
    concurrency: retry
    input: integer
    output: integer
    query: true
  transfer:
    concurrency: none
    input: id   # source balance
    output: integer
    query: true # target balance
  nullify:
    concurrency: retry
    output: integer

extensions:
  resources:
    /:id:
      operations: [observe]
